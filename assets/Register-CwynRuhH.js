import{r as E,i as S,e as k,b as N,d as P,q as F,v as C,j as e,t as R}from"./index-Bj6IjsBP.js";import{z as n,u as T,t as q,I as u}from"./Input-BPVwYEkj.js";import{H as B,D,p as H,S as I}from"./Heading-CiWTgu_3.js";import{R as z,C as L}from"./Row-CkZGBLgn.js";const O=n.object({firstName:n.string().trim().min(1,{message:"First name is required "}),lastName:n.string().trim().min(1,{message:"Last name is required "}),email:n.string().min(1,{message:"Email is required "}).email(),password:n.string().min(8,{message:"Password must be at least 8 characters longs"}).regex(/.*[!@#$%^&*()_+{}|[\]\\:";`<>?,./].*/,{message:"Password should contain at least 1 special character "}),confirmPassword:n.string().min(1,{message:"confirm Password  is required "})}).refine(a=>a.password===a.confirmPassword,{message:"ConfirmPassword and Password does not match",path:["confirmPassword"]}),U=()=>{const[a,r]=E.useState("idle"),[o,s]=E.useState(null);return{EmailAvailabiiltyStatus:a,EnterEmail:o,checkEmailAvailabiilty:async l=>{s(l),r("checking");try{(await S.get(`/users?email=${l}`)).data.length?r("notAvialabla"):r("available")}catch{r("failed")}},resetCheckemailAvailability:()=>{r("idle"),s(null)}}},_=()=>{const a=k(),r=N(),{loading:o,error:s,accessToken:i}=P(d=>d.auth),{register:t,handleSubmit:l,formState:{errors:m},getFieldState:w,trigger:g}=T({mode:"onBlur",resolver:q(O)}),{EnterEmail:c,EmailAvailabiiltyStatus:p,checkEmailAvailabiilty:h,resetCheckemailAvailability:b}=U(),f=async d=>{const{firstName:v,lastName:y,email:x,password:A}=d;a(C({firstName:v,lastName:y,email:x,password:A})).unwrap().then(()=>{r("/login?message=account_created")})},j=async d=>{await g("email");const v=d.target.value,{isDirty:y,invalid:x}=w("email");y&&!x&&c!==v&&h(v),y&&x&&c&&b()};return E.useEffect(()=>()=>{a(F())},[a]),{loading:o,error:s,accessToken:i,formErrors:m,EmailAvailabiiltyStatus:p,register:t,handleSubmit:l,submitForm:f,OnBlurHandler:j}},K=()=>{var g,c,p,h,b,f;const{loading:a,error:r,accessToken:o,formErrors:s,EmailAvailabiiltyStatus:i,register:t,handleSubmit:l,submitForm:m,OnBlurHandler:w}=_();return o?e.jsx(R,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"User Registration"}),e.jsx(z,{className:"mb-5",children:e.jsx(L,{md:{span:6,offset:3},children:e.jsxs(D,{onSubmit:l(m),children:[e.jsx(u,{label:"First Name",type:"text",name:"firstName",register:t,error:(g=s.firstName)==null?void 0:g.message}),e.jsx(u,{label:"Last Name",type:"text",name:"lastName",register:t,error:(c=s.lastName)==null?void 0:c.message}),e.jsx(u,{label:"Email",type:"text",name:"email",register:t,onBlur:w,error:(p=s.email)!=null&&p.message?(h=s.email)==null?void 0:h.message:i==="notAvialabla"?"This email already is used .":i==="failed"?"Error from the server.":"",formText:i==="checking"?"We`re currently the availability of this email address. Please wait a moment .":"",success:i==="available"?"This email is available for use .":"",disabled:i==="checking"?!0:a==="pending"}),e.jsx(u,{label:"Password",type:"password",name:"password",register:t,error:(b=s.password)==null?void 0:b.message}),e.jsx(u,{label:"confirm Password",type:"password",name:"confirmPassword",register:t,error:(f=s.confirmPassword)==null?void 0:f.message}),e.jsx(H,{variant:"success",type:"submit",style:{color:"white"},disabled:i==="checking"?!0:i==="notAvialabla",children:a==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(I,{animation:"border",size:"sm"})," laoding..."]}):"Submit"}),r&&e.jsx("p",{style:{color:"#DC3545",marginTop:"10px"},children:r})]})})})]})};export{K as default};
